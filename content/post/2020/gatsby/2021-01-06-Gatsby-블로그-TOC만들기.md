---
title: 'Gatsby ë¸”ë¡œê·¸ TOC ë§Œë“¤ê¸°'
date: 2021-01-07 23:10:13
draft: false
category: 'gatsby'
tags: ['gatsby', 'ë‚´ì†ë‚´ë§Œë¸”ë¡œê·¸']
---

## TOC ì²­ì‚¬ì§„ ê³ ë¥´ê¸°

ë¸”ë¡œê·¸ë¥¼ ë§Œë“¤ë©´ì„œ TOCë¥¼ ì¶”ê°€í•´ì•¼ê² ë‹¤ê³  ê²°ì •í•˜ì˜€ë‹¤.

ì´ë˜ì €ë˜ ë‹¤ë¥¸ë¸”ë¡œê·¸ë“¤ì€ TOCë¥¼ ì–´ë–»ê²Œ êµ¬ì„±í•˜ì˜€ë‚˜ ë‘˜ëŸ¬ë³´ë˜ì°¸ì—,
ì˜ˆì „ì— [HEROPHYë‹˜ì˜ ë¸”ë¡œê·¸](https://heropy.blog/)ì˜ TOCê°€ ìƒê°ë‚¬ë‹¤.

ì•ˆê·¸ë˜ë„ HEROPHYë‹˜ì˜ ë¸”ë¡œê·¸ê°€ ê¹”ë”í•˜ê³  ì˜ˆë»ì„œ ì°¸ê³ í•˜ë ¤ëŠ” ê¸°ëŠ¥ë“¤ì´ ìˆì—ˆëŠ”ë°,
ì´ì°¸ì— HEROPHYë‹˜ì—ê²Œ í´ë¡ ì„ í•´ë„ë˜ëŠ”ì§€ ë¬¼ì–´ë³´ê¸°ë¡œí–ˆë‹¤.

### í´ë¡ ì½”ë”© í—ˆë½

HEROPHYë‹˜ì—ê²Œ ë¸”ë¡œê·¸ ëª‡ê°€ì§€ ê¸°ëŠ¥ì—ëŒ€í•´ì„œ í´ë¡ ì½”ë”©ì„ í•´ë„ ê´œì°®ì€ì§€ ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ ë©”ì¼ì„ í†µí•´ ë¬¼ì–´ë³´ì•˜ê³  ë‹µë³€ì„ ë°›ì•˜ë‹¤.

![í´ë¡ ì½”ë”©í—ˆë½](.\Gatsby-ë¸”ë¡œê·¸-TOCë§Œë“¤ê¸°-í´ë¡ í—ˆë½.png)

> ì˜ˆìœ ë¸”ë¡œê·¸ë§Œí¼ì´ë‚˜ ë§ˆìŒì”¨ë„ ì˜ˆì˜ì‹  ê²ƒ ê°™ë‹¤.

ì´ë ‡ê²Œ ëŒ€ëµì ì¸ ëª¨ë¸ì´ ì •í•´ì¡Œìœ¼ë¯€ë¡œ í´ë¡ ì½”ë”©ì„ ì‹œì‘í•˜ë©´ ë˜ëŠ”ë°,
ë‚˜ëŠ” ì—¬ê¸°ì„œ <u>TOC Linkì—ë§Œ í•˜ì´ë¼ì´íŒ…ì„ í•˜ëŠ” ê²ƒ ëŒ€ì‹  í¬ìŠ¤íŠ¸ì˜ Headerì—ë„ í•˜ì´ë¼ì´íŒ… ì²˜ë¦¬</u>ë¥¼ í•˜ê¸°ë¡œ í•˜ì˜€ë‹¤.

ê·¸ëŸ¼ ì‹œì‘.

## TOC ë§Œë“¤ê¸°

### 1. Headerì— ë§í¬ê±¸ê¸°

#### gatsby-remark-autolink-headers

Headerì— ë§í¬ë¥¼ ê±°ëŠ” ë°©ë²•ì€ `gatsby-remark-autolink-headers`ë¥¼ ì´ìš©í•˜ë©´ ì‰½ê²Œ Markdownì— ìˆëŠ” Headerë“¤ì— ë¹Œë“œí•  ë•Œ ìë™ìœ¼ë¡œ ë§í¬ë¥¼ ê±¸ì–´ì¤€ë‹¤. ([ì°¸ì¡°](https://www.gatsbyjs.com/plugins/gatsby-remark-autolink-headers/?=remark))

ì—­ì‹œ gatsbyëŠ” remarkê´€ë ¨ í”ŒëŸ¬ê·¸ì¸ë“¤ì´ ë§ê³  ì›í•˜ëŠ” ê¸°ëŠ¥ì„ ì°¾ìœ¼ë©´ ë‹¤ ìˆì–´ì„œ [JAMStack]()ì— ëŒ€í•œ ì§€ì›ì´ ì•„ì£¼ ì¢‹ë‹¤ê³  ìƒê°í–ˆê³  gatsbyë¥¼ ë¸”ë¡œê·¸ë¡œ ì„ íƒí•œ ê²ƒì„ ì˜í–ˆë‹¤ê³  ëŠë¼ê³  ìˆë‹¤.

ë‚˜ëŠ” Jbeeë‹˜ì˜ [Gatsby-starter-bee](https://github.com/JaeYeopHan/gatsby-starter-bee)ë¥¼ ì‚¬ìš©í–ˆëŠ”ë° ì´ë¯¸ í¬í•¨ë˜ì–´ìˆìœ¼ë¯€ë¡œ ì¶”ê°€ ì„¤ì¹˜ì‘ì—…ì€ í•˜ì§€ ì•Šì•˜ë‹¤.

```js
npm install gatsby-remark-autolink-headers
```

#### autolink ì»¤ìŠ¤í„°ë§ˆì´ì§•

`gatsby-config.js`ì—ì„œ ì•„ë˜ì™€ê°™ì´ [autolink ì»¤ìŠ¤í„°ë§ˆì´ì§•](https://www.gatsbyjs.com/plugins/gatsby-remark-autolink-headers/?=remark#options)ì„ í•  ìˆ˜ ìˆë‹¤.

```js
// In your gatsby-config.js
module.exports = {
  plugins: [
    {
      resolve: `gatsby-transformer-remark`,
      options: {
        plugins: [
          {
            resolve: `gatsby-remark-autolink-headers`,
            options: {
              offsetY: `100`,
              icon: `<svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>`,
              className: `custom-class`,
              maintainCase: true,
              removeAccents: true,
              isIconAfterHeader: true,
              elements: [`h1`, `h4`],
            },
          },
        ],
      },
    },
  ],
}
```

### 2. TOC ê°€ì ¸ì˜¤ê¸°

TOCë¥¼ ê°€ì ¸ì˜¤ëŠ” ë°©ë²•ì€ GraphQL Queryë¡œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤. (remarkë¡œ markdown ë¹Œë“œë¥¼ í–ˆì„ì‹œì—)

```js{6}
export const pageQuery = graphql`
  query getTableOfContentsExample($slug: String!) {
    markdownRemark() {
      id
      html
      tableOfContents
      frontmatter {
        title
        date(formatString: "MMMM DD, YYYY")
      }
    }
  }
`
```

ìœ„ ì²˜ëŸ¼ `tableOfContents` í‚¤ê°’ìœ¼ë¡œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.

í•´ë‹¹ GraphQL QueryëŠ” markdowníŒŒì¼ì— ì ìš©ë˜ëŠ” templateì— ì ìš©ì‹œí‚¤ë©´ ë˜ê² ë‹¤. (`blog-post.js` template)

### 3. TOC ì»´í¬ë„ŒíŠ¸ ìƒì„±

ìœ„ ì¿¼ë¦¬ë¡œ ê°€ì ¸ì˜¨ tableOfContentsì˜ ë°ì´í„°ê°€ textê°’ìœ¼ë¡œ ë‹¤ìŒê³¼ê°™ì´ ê°€ì ¸ì˜¤ê¸° ë•Œë¬¸ì—,

```json{4}
{
  "data": {
    "markdownRemark": {
      "tableOfContents": "<ul>\n<li><a href='#fragment1'>First Heading</a></li>\n<li><a href='#fragment2'>Second Heading</a></li>\n</ul>"
    }
  }
}
```

html tagì— `dangerouslySetInnerHTML`ë¡œ ì ìš©ì‹œí‚¤ë©´ ë³„ë„ í•¸ë“¤ë§ ì—†ì´ ê·¸ëŒ€ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.

```js{7}
export const TableOfContents = ({ toc }) => {
  // ...
  return (
    <div className="toc-container">
      <div className="toc-wrapper">
        <div className="toc-content">
          <div className="toc" dangerouslySetInnerHTML={{ __html: toc }} />
        </div>
        <div className="toc-open-btn" onClick={onClickTOCOpen}></div>
      </div>
    </div>
  )
}
```

ë‹¤ìŒê³¼ ê°™ì€ í˜•ì‹ì„ ì·¨í•´ì£¼ë©´ ëœë‹¤.

### 4. TOCì— í•˜ì´ë¼ì´íŠ¸íš¨ê³¼ ë¶€ì—¬

ì´ ë°©ë²•ì„ ì‹¤í˜„í•˜ë ¤ë©´ ë‘ ê°€ì§€ ë°©ë²•ì´ ìˆëŠ” ê²ƒ ê°™ë‹¤.

- `scrollEvent`ì—ì„œ Headerê°€ ìœ—ë¶€ë¶„ìœ¼ë¡œ ì˜¤ëŠ”ì§€ ì²´í¬
- `IntersectionObserver`ë¥¼ `rootMargin`ì„ ìœ„ìª½ì˜ì—­ìœ¼ë¡œ í•˜ì—¬ ê°€ì‹œì„±ì´ ë³´ì´ëŠ” ìˆœê°„(`isIntersecting`) ì²´í¬

ê°œì¸ì ì¸ íŒë‹¨ìœ¼ë¡œëŠ” `scrollEvent`ì—ì„œ ìŠ¤í¬ë¡¤ì˜ ë§¤ ìˆœê°„ headerì˜ ì˜ì—­ê³¼ window `offsetY`ë¥¼ ì²´í¬í•˜ì—¬ ê³„ì‚°í•˜ê¸°ë³´ë‹¤ëŠ” `IntersectionObserver`ë¡œ Headerë“¤ì˜ ê°€ì‹œì„±ì´ ë³€í™˜ ë  ë•Œë§Œ ì²´í¬ë¥¼ í•˜ëŠ” ê²ƒì´ ë” íš¨ìœ¨ì ìœ¼ë¡œ ìƒê°ë˜ì—ˆë‹¤.

ë”°ë¼ì„œ `IntersectionObserver`ë¥¼ ì´ìš©í•´ ì²´í¬í•˜ê¸°ë¡œ ê²°ì •.

> IntersectionObserverì— ëŒ€í•´ì„œ ì˜ ëª¨ë¥¸ë‹¤ë©´ [HEROPYë‹˜ì˜ í¬ìŠ¤íŒ…](https://heropy.blog/2019/10/27/intersection-observer/)ì„ ì°¸ê³ í•˜ì.
>
> ì •ë¦¬ê°€ ë§¤ìš° ì˜ ë˜ì–´ ìˆë‹¤. ğŸ‘

```js{7-15}{numberLines: true}
useEffect(() => {
  observer = new IntersectionObserver(
    entries => {
      entries.forEach(entry => {
        const headerElement = entry.target
        const tocLinkElement = Dom.getElement(
          `a[href*="${encodeURI(header.id)}"]`
        )

        if (entry.isIntersecting) {
          headerElement.classList.add('toc-header-active')
          tocLinkElement.classList.add('toc-active')
        } else if (currentYPos < targetStaticYPos) {
          // ìŠ¤í¬ë¡¤ì„ ìœ„ë¡œ ì˜¬ë ¤ì„œ í—¤ë” ì£¼ì œë¥¼ ë²—ì–´ë‚œ ê²½ìš°
          headerElement.classList.remove('toc-header-active')
          tocLinkElement.classList.remove('toc-active')
        }
      })
    },
    { rootMargin: `0% 0% -85% 0%` }
  )

  headerElements = getHeaderElements()

  headerElements.forEach(headerElement => {
    observer.observe(headerElement)
  })
})
```

ë‹¤ìŒê³¼ ê°™ì´ `TableOfContents` ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ `IntersectionObserver`ë¥¼ ì´ìš©í•´ í˜„ì¬ ë³´ê³ ìˆëŠ” Contentì˜ Headerë¥¼ ì²´í¬í•˜ê³  íš¨ê³¼ë¥¼ ì£¼ê¸°ìœ„í•´ css classë¥¼ toggleí•˜ì˜€ë‹¤.

observingí•˜ëŠ” rootëŠ” `0% 0% -85% 0%`ë¡œ ì„¤ì •í•´ì„œ Headerê°€ rootë¡œ ì„¤ì •í•œ ìƒìœ„ observing ì˜ì—­ì— ì˜¬ ê²½ìš°
`entry.isIntersection`ìœ¼ë¡œ ì²´í¬í•˜ì˜€ë‹¤.

ì—¬ê¸°ì„œ ì´ê²ƒì €ê²ƒ í•´ë³´ë‹¤ê°€ ë°œê²¬í•œ ì‚¬ì‹¤ì´ ë˜ ìˆëŠ”ë°
`entry.boundingClientRect.top + window.pageYOffset`ì˜ ê²°ê³¼ê°€ Elementì˜ staticí•œ top ì¢Œí‘œë¼ëŠ” ì‚¬ì‹¤ì„ ì•Œê²Œë˜ì—ˆë‹¤.

<img src=".\Gatsby-ë¸”ë¡œê·¸-TOCë§Œë“¤ê¸°-rootMargin.png" alt="rootMargin" style="zoom:67%;" />

### 5. ë¬¸ì œì  ë°œê²¬

ì´ ë‹¤ìŒë‹¨ê³„ë¡œ `Intersectioning` í•˜ëŠ” ë¶€ë¶„ì„ ë”°ë¡œ hooksë¡œ ë¶„ë¦¬ì‹œí‚¤ëŠ” ë“±ì˜ ë¦¬íŒ©í† ë§ì„ ì§„í–‰í•˜ë ¤ê³  í•˜ì˜€ìœ¼ë‚˜,
ë¬¸ì œì ì„ ë°œê²¬í•˜ì˜€ë‹¤.

ë‚˜ëŠ” `entry.isIntersection`ìœ¼ë¡œ ì²´í¬ê°€ ë˜ì—ˆì„ ë•Œ í•˜ì´ë¼ì´íŒ…ì²˜ë¦¬, `IntersectionObserver`ë¥¼ í†µí•œ ê³„ì‚°ê°’ìœ¼ë¡œ ìŠ¤í¬ë¡¤ì„ í—¤ë” ìœ„ë¡œ ì˜¬ë ¸ì„ë•Œ í•˜ì´ë¼ì´íŒ…ì„ ì œê±°í•˜ë„ë¡í•´ì„œ css classë¥¼ toggleì‹œí‚¤ëŠ” ë°©ë²•ì„ ì„ íƒí–ˆì—ˆë‹¤.

ìŠ¤í¬ë¡¤ í•˜ë©´ì„œ ì²˜ìŒ ë³´ì—¬ì§ˆ ë•Œ css classnameì„ ì¶”ê°€í•´ì„œ í•˜ì´ë¼ì´íŠ¸ ì²˜ë¦¬ê°€ ë˜ë„ë¡í•˜ê³ ,
ìŠ¤í¬ë¡¤ì„ ìœ„ë¡œì˜¬ë¦¬ë©´ì„œ ë‘ë²ˆì§¸ë¡œ ë³´ì—¬ì§ˆ ë•Œ cssclassnameì„ ì œê±°í•˜ë©´ì„œ í•˜ì´ë¼ì´íŠ¸ë¥¼ ì œê±°í•˜ë ¤ê³  í•˜ì˜€ë‹¤.

> HEROPHYë‹˜ Tech blog ì²˜ëŸ¼ ì½ì€ ì£¼ì œì— ëŒ€í•´ì„œëŠ” í•˜ì´ë¼ì´íŠ¸, ë‹¤ì‹œ ìœ„ë¡œ ì˜¬ë¦¬ë©´ í•˜ì´ë¼ì´íŠ¸ì œê±°

í•˜ì§€ë§Œ, **header #ê²½ë¡œë¡œ ì´ë™í•  ë•Œ ìŠ¤í¬ë¡¤ì˜ ì†ë„ê°€ ë„ˆë¬´ ë¹¨ë¼ `isIntersection` `true`ê°€ ë°œìƒí•˜ì§€ì•Šì•„ toggleì´ ê¼¬ì´ëŠ” ìƒí™©ì´ ë°œìƒ**í•˜ì˜€ë‹¤.

ê·¸ë˜ì„œ ì´ë˜ì €ë˜ ë¡œê·¸ë„ ì°ì–´ë³´ë©´ì„œ ë°©ë²•ì„ ê°•êµ¬í•œ ê²°ê³¼, `scroll Event`ë¡œ ê° Headerë“¤ì˜ ìœ„ì¹˜íŒë‹¨ìœ¼ë¡œ ì ìš©ì‹œí‚¤ê¸°ë¡œ í•˜ì˜€ë‹¤.

#### í•´ê²°ì±…

- `Scroll Event` ì‚¬ìš©í•˜ê¸°ë¡œ ê²°ì •
- ë‚®ì•„ì§„ íš¨ìœ¨ì„±ì€ `Scroll Event`ì— Task Queue(Event Queue)ëŒ€ì‹  Animation frames(`rAF`)ìœ¼ë¡œ ì²˜ë¦¬ë˜ë„ë¡ í•˜ê¸° - [Jbeeë‹˜ì˜ ìŠ¤í¬ë¡¤ì´ë²¤íŠ¸ ìµœì í™” í¬ìŠ¤íŠ¸ ì°¸ì¡°](https://jbee.io/web/optimize-scroll-event/)

### 6. í•´ê²°ì±… (Scroll event) ì ìš©

ìœ„ í•´ê²°ì±…ì„ ì ìš©í•˜ê¸° ìœ„í•´ ê¸°ì¡´ì— [gatsby-starter-bee](https://github.com/JaeYeopHan/gatsby-starter-bee) ì— ì¡´ì¬í•˜ëŠ” `onScroll`ê³¼ `toFit`ì„ ì ìš©ì‹œí‚¤ê³  scroll Eventë¡œ ì˜ ìˆ˜í–‰ë˜ëŠ”ì§€ í™•ì¸í•´ë³´ì•˜ë‹¤.

```js{21-23}{numberLines: true}
// TableOfContents
const onScroll = () => {
  const currentoffsetY = window.pageYOffset
  const headerElements = getHeaderElements()
  for (const headerElement of headerElements) {
    const { top } = headerElement.getBoundingClientRect()
    const elementTop = top + currentoffsetY
    const tocLinkElement = Dom.getElement(
      `a[href*="${encodeURI(headerElement.id)}"]`
    )
    if (currentoffsetY >= elementTop - HEADER_OFFSET_Y) {
      headerElement.classList.add('toc-header-active')
      tocLinkElement.classList.add('toc-active')
    } else {
      headerElement.classList.remove('toc-header-active')
      tocLinkElement.classList.remove('toc-active')
    }
  }
}

useScrollEvent(() => {
  return EventManager.toFit(onScroll, {})()
})
```

ì˜ ì‘ë™í•˜ëŠ” ê²ƒì„ í™•ì¸í•˜ì˜€ë‹¤.

ì ìš©ëœ `useScrollEvent`ì™€ `toFit` í•¨ìˆ˜ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.

```js
// useScrollEvent
import { useEffect } from 'react'

export function useScrollEvent(onScroll) {
  useEffect(() => {
    window.addEventListener(`scroll`, onScroll, { passive: false })
    return () => {
      window.removeEventListener(`scroll`, onScroll, { passive: false })
    }
  }, [])
}
```

```js
// toFit
export function toFit(
  cb,
  { dismissCondition = () => false, triggerCondition = () => true }
) {
  if (!cb) {
    throw Error('Invalid required arguments')
  }

  let tick = false

  return function() {
    if (tick) {
      return
    }

    tick = true
    return requestAnimationFrame(() => {
      if (dismissCondition()) {
        tick = false
        return
      }

      if (triggerCondition()) {
        tick = false
        return cb()
      }
    })
  }
}
```

### 7. # url ë¶ˆí¸í•¨ ì œê±°

ë‹¤ ì™„ì„±í•˜ê³  ë‚œ í›„ì— ì´ë˜ì €ë˜ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³´ë‹¤ë³´ë‹ˆ ë¶ˆí¸í•¨ ì ì„ ë°œê²¬í–ˆë‹¤.
TOC ì»´í¬ë„ŒíŠ¸ì˜ Linkë¥¼ í´ë¦­í•˜ë©´ `originURL/#header` ì²˜ëŸ¼ urlì´ ë°”ë€Œê¸° ë•Œë¬¸ì— ë‚˜ì¤‘ì— ë’¤ë¡œê°€ê¸°ë¥¼ ìˆ˜í–‰í•˜ì˜€ì„ ê²½ìš° ì´ì „ì— í´ë¦­í–ˆë˜ TOC Link(URL)ë¡œ ì´ë™í•˜ê²Œ ë˜ëŠ” ê²ƒ.

ê·¸ë˜ì„œ ë²ˆê±°ë¡­ì§€ë§Œ ê° TOC Linkì— <u>Click EventListener</u>ë¥¼ ì¶”ê°€í•˜ì˜€ë‹¤.

```js{12-15}
useEffect(() => {
  const headerElements = getHeaderElements()

  headerElements.forEach(headerElement => {
    headerElement.classList.add('toc-header') // active ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ë¥¼ ìœ„í•´ ì‚¬ì „ì— í´ë˜ìŠ¤ ì¶”ê°€

    const headerElementTop = getElementTopPos(headerElement)
    const tocLinkElement = Dom.getElement(
      `a[href*="${encodeURI(headerElement.id)}"]`
    )

    tocLinkElement.addEventListener('click', e => {
      e.preventDefault()
      window.scroll({ top: headerElementTop, behavior: 'smooth' })
    })
  })
})
```

## ë§ˆë¬´ë¦¬

ì–´ì°Œë³´ë©´ ê°„ë‹¨í•œ ê¸°ëŠ¥ì²˜ëŸ¼ ë³´ì´ëŠ”ë°, ìƒê°ë³´ë‹¤ ì˜¤ë˜ì‘ì—…í•˜ê²Œ ë˜ì—ˆê³  ë°°ìš´ê²ƒë„ ì •ë§ ë§ë‹¤.

- IntersectionObserver
- CSS `className[propertyName*="likeSearch"]` ì„ íƒì
- scroll event ìµœì í™”
- window.scroll
- ë¯¸ë¦¬ ì‘ì„±ëœ ì–‘ì§ˆì˜ ì½”ë“œ ì¬ì‚¬ìš© (`Jbee` ë‹˜ì˜ ì†ŒìŠ¤ë¥¼ ë³´ë©´ì„œ ë§ì´ ë°°ì› ë‹¤.)

## ì°¸ì¡°

- [HEROPHYë‹˜ì˜ IntersectionObserver](https://heropy.blog/2019/10/27/intersection-observer/)
- [ë³´ë…¸ë‹˜ì˜ TOCë§Œë“¤ê¸° í¬ìŠ¤íŠ¸](https://blueshw.github.io/2020/05/30/table-of-contents/)
- [Jbeeë‹˜ì˜ ìŠ¤í¬ë¡¤ì´ë²¤íŠ¸ ìµœì í™”](https://jbee.io/web/optimize-scroll-event/)
